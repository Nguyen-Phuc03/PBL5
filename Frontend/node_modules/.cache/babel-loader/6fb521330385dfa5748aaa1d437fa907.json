{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\USER\\\\Downloads\\\\PBL5_Demo\\\\PBL5_Demo\\\\Frontend\\\\src\\\\components\\\\EnrollToCoursePage\\\\EnrollToCoursePage.js\";\nimport React, { Component } from 'react';\nimport { connect } from 'react-redux';\nimport { getAndSetStudents } from '../../actions/students';\nimport getAndSetCourses from '../../actions/courses';\nimport { getUsernameFromCookie } from '../../helperFunction/getCookie';\nimport setInputState from '../../genericFunctions/setInputState';\nimport './_enrollToCoursePage.scss';\n\nclass EnrollToCoursePage extends Component {\n  constructor(props) {\n    super(props);\n\n    this.onFileInputChange = e => {\n      const value = e.target.files[0];\n      setInputState.call(this, \"\");\n      this.setState(prevState => {\n        return {\n          data: { ...prevState.data,\n            studentImage: value\n          }\n        };\n      });\n    };\n\n    this.onInputChange = e => {\n      const name = e.target.id;\n      const value = !this.state.data.courseData[name];\n      this.setState(prevState => {\n        return {\n          data: { ...prevState.data,\n            courseData: { ...prevState.data.courseData,\n              [name]: value\n            }\n          }\n        };\n      });\n    };\n\n    this.setErrors = toUpdate => {\n      this.setState(prevState => {\n        return {\n          errors: { ...prevState.errors,\n            ...toUpdate\n          }\n        };\n      }, () => console.log(this.state.errors));\n      this.setState({\n        errorsExists: true\n      });\n    };\n\n    this.clearAllErrors = () => {\n      this.setErrors({\n        roll_no: \"\",\n        otherError: \"\"\n      });\n      this.setState({\n        errorsExists: false\n      });\n    };\n\n    this.handleResponse = responseArray => {\n      /**\n       * Array of response if send each for each course\n       * which student option to select \n       */\n      responseArray.forEach(response => {\n        const {\n          name\n        } = response;\n        const {\n          message,\n          status\n        } = response.result;\n\n        if (response.status === 200) {\n          switch (status) {\n            case 201:\n              console.log(message);\n              setInputState.call(this, \"messages\", name, message);\n              break;\n\n            case 409:\n              console.log(message);\n              setInputState.call(this, \"messages\", name, message);\n              break;\n\n            case 400:\n              this.setErrors({\n                otherError: message\n              });\n              console.log(message);\n              break;\n\n            default:\n              break;\n          }\n        }\n      });\n    };\n\n    this.makeRequest = requestUrl => {\n      let formData = new FormData();\n      const {\n        studentImage,\n        courseData\n      } = this.state.data;\n      /**\n       * Used formData only because we need to send file \n       * to server , it cant be dont otherwise\n       */\n\n      formData.append('file', studentImage);\n      formData.append(\"courseData\", JSON.stringify(courseData));\n      formData.append(\"roll_no\", this.props.students[0].roll_no);\n      const options = {\n        method: 'POST',\n        body: formData\n      };\n\n      if (!this.state.errorsExists) {\n        fetch('http://localhost:5000/enroll_student', options); //fetch(requestUrl,options)\n\n        const responseData = response.json();\n        console.log(responseData);\n\n        responseArray => this.handleResponse(responseArray); // .then(response => response.json())\n        // .then(responseArray => this.handleResponse(responseArray))\n\n      }\n    };\n\n    this.onSubmit = e => {\n      e.preventDefault();\n      /**\n       * FIRST CLEAR ALL ERROR \n       * AND\n       * APPLY AUTHENTICATION TO CHECK FOR ERRORS\n      */\n\n      this.clearAllErrors();\n      this.applyAuthentication();\n      /**\n       * IF THERE IS NO ERRORS ONLY THEN \n       * MAKE THE REQUEST OTHERWISE DO NOTHING\n       * \n       * AND \n       * \n       * THERE WILL BE SHOWING ERROR ON THE FORM IF ANY EXIST\n      */\n      // .then(()=>{\n      //     console.log(\"IN\")\n      //     const url = \"http://localhost:5000/enroll_student\"\n      //     this.makeRequest(url); \n      // })\n    };\n\n    this.componentDidMount = () => {\n      /* \n          Set Student Filters and Projection \n          to get only Specified part of current Student\n      */\n      const studentFilters = {\n        username: getUsernameFromCookie()\n      };\n      const studentProjection = {\n        \"department\": true,\n        \"semester\": true,\n        \"roll_no\": true\n      };\n      /* \n          Make a Asnc Request to get the student details\n          Note :- It will return a Promise\n      */\n\n      this.props.setStudents(studentFilters, studentProjection).then(() => {\n        /* \n            Now Set Filter and Projection to Get \n            Only Coures Related to the loogedIn Student\n        */\n        const loggedStudent = this.props.students[0];\n        const {\n          department,\n          semester\n        } = loggedStudent;\n        const courseFilters = {\n          department,\n          semester\n        };\n        const courseProjection = {\n          \"name\": true\n        };\n        /* \n            Make the Asnc Request to get the Courses \n        */\n\n        this.props.setCourses(courseFilters, courseProjection).then(() => {\n          /*\n              Set False For all Course in The State\n              \"FALSE\" represents that CheckBox is unchecked\n              and will be change to True when CheckBox is Checked\n          */\n          this.props.courses.forEach(course => {\n            this.setState(prevState => {\n              return {\n                data: { ...prevState.data,\n                  courseData: { ...prevState.data.courseData,\n                    [course.name]: false\n                  }\n                }\n              };\n            });\n          });\n          this.setState({\n            isFetching: true\n          });\n        });\n      });\n    };\n\n    this.state = {\n      isFetching: false,\n      FetchingTime: 100,\n      data: {\n        studentImage: undefined\n      },\n      errorsExists: false,\n      errors: {\n        courseError: \"\",\n        fileError: \"\",\n        otherError: \"\"\n      },\n      messages: {}\n    };\n  } ///////////////////////// INPUT HANDLERS //////////////////////////////\n\n\n  applyAuthentication() {\n    const data = this.state.data;\n    const {\n      courseData,\n      studentImage\n    } = data;\n    return new Promise((resolve, reject) => {\n      /**\n       * Checking that has student aleast selected \n       * on course to enroll in\n       */\n      let courseDataError = true;\n\n      for (const key in courseData) {\n        if (courseData[key]) {\n          courseDataError = false;\n        }\n      }\n\n      if (courseDataError) {\n        this.setErrors({\n          courseError: \"Atleast Select one course\"\n        });\n      }\n      /**\n       * Checking if file have been uploaded or not\n       */\n\n\n      if (studentImage === undefined) {\n        this.setErrors({\n          fileError: \"Upload a File\"\n        });\n      }\n\n      resolve();\n    });\n  } ///////////////////////// ERROR HANDLERS ENDS//////////////////////////////////\n  //////////////////////// REQUEST RELATED FUNCTIONS ////////////////////////////\n\n\n  render() {\n    if (!this.state.isFetching) {\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: \"Enroll_MainBody sidePage\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 278,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"Enroll_Container\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 279,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"Enroll_FormContainer\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 280,\n          columnNumber: 25\n        }\n      }, /*#__PURE__*/React.createElement(\"header\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 281,\n          columnNumber: 29\n        }\n      }, /*#__PURE__*/React.createElement(\"h1\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 282,\n          columnNumber: 33\n        }\n      }, \"Add Course\")), /*#__PURE__*/React.createElement(\"form\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 284,\n          columnNumber: 29\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 285,\n          columnNumber: 33\n        }\n      }, /*#__PURE__*/React.createElement(\"p\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 286,\n          columnNumber: 37\n        }\n      }, \"Fetching ....\"))))));\n    } else {\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: \"MainBody Enroll_MainBody sidePage\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 295,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"Container Enroll_Container\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 296,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"FormContainer Enroll_FormContainer\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 297,\n          columnNumber: 25\n        }\n      }, /*#__PURE__*/React.createElement(\"header\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 298,\n          columnNumber: 29\n        }\n      }, /*#__PURE__*/React.createElement(\"h1\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 299,\n          columnNumber: 33\n        }\n      }, \"Enroll\", /*#__PURE__*/React.createElement(\"span\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 300,\n          columnNumber: 43\n        }\n      }, \"(\", this.props.students[0].roll_no, \")\"))), this.state.message && /*#__PURE__*/React.createElement(\"span\", {\n        className: \"confirmationMessage\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 303,\n          columnNumber: 52\n        }\n      }, this.state.message), this.state.errors.courseExist && /*#__PURE__*/React.createElement(\"span\", {\n        className: \"errorMessage\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 304,\n          columnNumber: 63\n        }\n      }, this.state.errors.courseExist), /*#__PURE__*/React.createElement(\"form\", {\n        onSubmit: this.onSubmit,\n        encType: \"multipart/form-data\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 305,\n          columnNumber: 29\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 306,\n          columnNumber: 33\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"inputErrorDiv\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 307,\n          columnNumber: 37\n        }\n      }, this.props.courses.map(course => {\n        const {\n          name,\n          department,\n          semester\n        } = course;\n        return /*#__PURE__*/React.createElement(\"div\", {\n          key: name + department + semester,\n          className: \"courseCheckboxDiv\",\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 311,\n            columnNumber: 56\n          }\n        }, /*#__PURE__*/React.createElement(\"div\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 312,\n            columnNumber: 61\n          }\n        }, /*#__PURE__*/React.createElement(\"input\", {\n          type: \"checkbox\",\n          id: name,\n          placeholder: \"\",\n          value: this.state.data[name],\n          onChange: this.onInputChange,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 313,\n            columnNumber: 61\n          }\n        })), /*#__PURE__*/React.createElement(\"div\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 321,\n            columnNumber: 61\n          }\n        }, /*#__PURE__*/React.createElement(\"label\", {\n          className: \"Label\",\n          htmlFor: name,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 322,\n            columnNumber: 61\n          }\n        }, name, \" \", this.state.messages[name] && /*#__PURE__*/React.createElement(\"span\", {\n          className: \"confirmationMessage\",\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 326,\n            columnNumber: 102\n          }\n        }, this.state.messages[name]))));\n      }), this.state.errors.courseError && /*#__PURE__*/React.createElement(\"span\", {\n        className: \"errorMessage\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 332,\n          columnNumber: 71\n        }\n      }, this.state.errors.courseError))), /*#__PURE__*/React.createElement(\"div\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 336,\n          columnNumber: 33\n        }\n      }, /*#__PURE__*/React.createElement(\"label\", {\n        className: \"Label\",\n        htmlFor: \"name\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 337,\n          columnNumber: 37\n        }\n      }, \"Upload Image\"), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"inputErrorDiv\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 343,\n          columnNumber: 37\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"inputDiv\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 344,\n          columnNumber: 41\n        }\n      }, /*#__PURE__*/React.createElement(\"input\", {\n        type: \"file\",\n        id: \"studentImage\",\n        placeholder: \"\",\n        onChange: this.onFileInputChange,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 345,\n          columnNumber: 45\n        }\n      })), this.state.errors.fileError && /*#__PURE__*/React.createElement(\"span\", {\n        className: \"errorMessage\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 352,\n          columnNumber: 73\n        }\n      }, this.state.errors.fileError))), /*#__PURE__*/React.createElement(\"button\", {\n        className: \"Button\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 355,\n          columnNumber: 33\n        }\n      }, \"Enroll\")))));\n    }\n  }\n\n}\n\nconst mapStateToProps = state => {\n  return {\n    students: state.students,\n    courses: state.courses\n  };\n};\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    setStudents: (filters, projection) => dispatch(getAndSetStudents(filters, projection)),\n    setCourses: (filters, projection) => dispatch(getAndSetCourses(filters, projection))\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(EnrollToCoursePage);","map":{"version":3,"sources":["C:/Users/USER/Downloads/PBL5_Demo/PBL5_Demo/Frontend/src/components/EnrollToCoursePage/EnrollToCoursePage.js"],"names":["React","Component","connect","getAndSetStudents","getAndSetCourses","getUsernameFromCookie","setInputState","EnrollToCoursePage","constructor","props","onFileInputChange","e","value","target","files","call","setState","prevState","data","studentImage","onInputChange","name","id","state","courseData","setErrors","toUpdate","errors","console","log","errorsExists","clearAllErrors","roll_no","otherError","handleResponse","responseArray","forEach","response","message","status","result","makeRequest","requestUrl","formData","FormData","append","JSON","stringify","students","options","method","body","fetch","responseData","json","onSubmit","preventDefault","applyAuthentication","componentDidMount","studentFilters","username","studentProjection","setStudents","then","loggedStudent","department","semester","courseFilters","courseProjection","setCourses","courses","course","isFetching","FetchingTime","undefined","courseError","fileError","messages","Promise","resolve","reject","courseDataError","key","render","courseExist","map","mapStateToProps","mapDispatchToProps","dispatch","filters","projection"],"mappings":"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","sourcesContent":["import React , { Component } from 'react';\nimport { connect } from 'react-redux';\n\nimport { getAndSetStudents } from '../../actions/students';\nimport getAndSetCourses from '../../actions/courses';\nimport { getUsernameFromCookie } from '../../helperFunction/getCookie';\nimport setInputState from '../../genericFunctions/setInputState';\n\nimport './_enrollToCoursePage.scss';\n\nclass EnrollToCoursePage extends Component{\n    constructor(props){\n        super(props);\n        this.state = {\n            isFetching: false,\n            FetchingTime : 100 ,\n            data: {\n                studentImage: undefined\n            },\n            errorsExists: false,\n            errors:{\n                courseError: \"\",\n                fileError: \"\",\n                otherError: \"\"\n            },\n            messages: {} \n        }\n    }\n\n\n    ///////////////////////// INPUT HANDLERS //////////////////////////////\n    \n    onFileInputChange = (e) => {\n        const value = e.target.files[0];\n         setInputState.call(this,\"\")\n        this.setState((prevState)=>{\n            return {\n                data: {\n                    ...prevState.data,\n                    studentImage:value\n                }\n            }\n        })\n        \n    }\n    \n    onInputChange = (e)=>{\n        const name = e.target.id;\n        const value = !(this.state.data.courseData[name]);\n\n        this.setState((prevState)=>{\n            return {\n                data: {\n                    ...prevState.data, \n                    courseData : {\n                        ...prevState.data.courseData,\n                        [name] : value\n                    }\n                 }\n            }\n        })\n    }\n\n    ///////////////////////// INPUT HANDLERS ENDS//////////////////////////////\n\n\n    ///////////////////////// ERROR HANDLERS //////////////////////////////////\n\n    setErrors = (toUpdate)=>{\n        this.setState((prevState) =>{\n            return {\n                errors:{\n                    ...prevState.errors,\n                    ...toUpdate\n                }\n            }\n        },()=> console.log(this.state.errors))\n        this.setState({errorsExists: true});\n    }\n    \n    clearAllErrors = ()=>{\n        this.setErrors({\n            roll_no: \"\",\n            otherError: \"\"\n        })\n        this.setState({errorsExists: false});\n    }\n\n    \n    applyAuthentication(){\n        const data = this.state.data;\n\n        const { courseData, studentImage } = data\n        return new Promise((resolve,reject)=>{\n            /**\n             * Checking that has student aleast selected \n             * on course to enroll in\n             */\n            let courseDataError = true\n    \n            for( const key in courseData){\n                if(courseData[key]){ courseDataError = false}\n            }\n    \n            if(courseDataError){\n                this.setErrors({courseError: \"Atleast Select one course\"})\n            }\n    \n            /**\n             * Checking if file have been uploaded or not\n             */\n            if(studentImage === undefined){\n                this.setErrors({fileError: \"Upload a File\"})\n            }\n            resolve();\n        })\n    }\n\n    \n    ///////////////////////// ERROR HANDLERS ENDS//////////////////////////////////\n\n\n    //////////////////////// REQUEST RELATED FUNCTIONS ////////////////////////////\n\n\n    handleResponse = (responseArray)=>{\n        /**\n         * Array of response if send each for each course\n         * which student option to select \n         */\n        responseArray.forEach(response => {\n            const { name } = response;\n            const { message , status } = response.result;\n            if(response.status === 200){\n                switch(status){\n                    case 201:\n                        console.log(message)\n                        setInputState.call(this,\"messages\",name,message)\n                        break;\n                    case 409:\n                        console.log(message)\n                        setInputState.call(this,\"messages\",name,message)\n                        break\n                    case 400:\n                        this.setErrors({\n                            otherError: message\n                        })\n                        console.log(message)\n                        break;\n                        default:\n                            break\n                        }\n            }\n        })\n    }\n\n    makeRequest = (requestUrl) =>{\n        let formData = new FormData();\n        \n        const { studentImage, courseData }  = this.state.data;\n\n        /**\n         * Used formData only because we need to send file \n         * to server , it cant be dont otherwise\n         */\n        formData.append('file', studentImage)\n        formData.append(\"courseData\",JSON.stringify(courseData));\n        formData.append(\"roll_no\",this.props.students[0].roll_no)\n\n\n        const options = {\n            method: 'POST',\n            body: formData\n        }\n\n        if(!this.state.errorsExists){\n            fetch('http://localhost:5000/enroll_student', options)\n            //fetch(requestUrl,options)\n            const responseData = response.json();\n            console.log(responseData);\n            responseArray => this.handleResponse(responseArray);\n            // .then(response => response.json())\n            // .then(responseArray => this.handleResponse(responseArray))\n        }\n    }\n                    \n    onSubmit = (e)=>{\n        e.preventDefault();\n        \n        /**\n         * FIRST CLEAR ALL ERROR \n         * AND\n         * APPLY AUTHENTICATION TO CHECK FOR ERRORS\n        */\n        this.clearAllErrors();\n        this.applyAuthentication()\n\n        /**\n         * IF THERE IS NO ERRORS ONLY THEN \n         * MAKE THE REQUEST OTHERWISE DO NOTHING\n         * \n         * AND \n         * \n         * THERE WILL BE SHOWING ERROR ON THE FORM IF ANY EXIST\n        */\n        // .then(()=>{\n        //     console.log(\"IN\")\n        //     const url = \"http://localhost:5000/enroll_student\"\n        //     this.makeRequest(url); \n        // })\n        \n    }\n    \n    //////////////////////// REQUEST RELATED FUNCTIONS ENDS////////////////////////////\n\n    componentDidMount = ()=>{\n\n        /* \n            Set Student Filters and Projection \n            to get only Specified part of current Student\n        */\n\n        const studentFilters = {\n            username: getUsernameFromCookie()\n        }\n        const studentProjection = {\n            \"department\": true,\"semester\": true, \"roll_no\": true\n        }\n        /* \n            Make a Asnc Request to get the student details\n            Note :- It will return a Promise\n        */\n        this.props.setStudents(studentFilters,studentProjection)\n        .then(()=>{\n\n            /* \n                Now Set Filter and Projection to Get \n                Only Coures Related to the loogedIn Student\n            */\n            const loggedStudent = this.props.students[0];\n            const { department, semester } =loggedStudent;\n\n            const courseFilters = { department,semester }\n            const courseProjection = { \"name\": true }\n\n            /* \n                Make the Asnc Request to get the Courses \n            */\n            this.props.setCourses(courseFilters, courseProjection)\n            .then(()=> {\n\n                /*\n                    Set False For all Course in The State\n                    \"FALSE\" represents that CheckBox is unchecked\n                    and will be change to True when CheckBox is Checked\n                */\n                this.props.courses.forEach(course => {\n                    this.setState(prevState => {\n                        return {\n                            data: {\n                                ...prevState.data, \n                                courseData : {\n                                    ...prevState.data.courseData,\n                                    [course.name] : false\n                                }\n                                }\n                        }\n                    })\n                });\n                this.setState({isFetching: true})\n            })\n        })\n    }\n        \n    render() {\n        if(!this.state.isFetching){\n            return (\n                <div className=\"Enroll_MainBody sidePage\">\n                    <div className=\"Enroll_Container\">\n                        <div className=\"Enroll_FormContainer\">\n                            <header>\n                                <h1>Add Course</h1>\n                            </header>\n                            <form>\n                                <div>\n                                    <p>Fetching ....</p>\n                                </div>\n                            </form>\n                        </div>\n                    </div>\n                </div>\n            )\n        }else{\n            return (\n                <div className=\"MainBody Enroll_MainBody sidePage\">\n                    <div className=\"Container Enroll_Container\">\n                        <div className=\"FormContainer Enroll_FormContainer\">\n                            <header>\n                                <h1>\n                                    Enroll<span>({this.props.students[0].roll_no})</span>\n                                </h1>\n                            </header>\n                            {this.state.message && <span className=\"confirmationMessage\">{this.state.message}</span>}\n                            {this.state.errors.courseExist && <span className=\"errorMessage\">{this.state.errors.courseExist}</span>}\n                            <form onSubmit={this.onSubmit} encType=\"multipart/form-data\">\n                                <div>\n                                    <div className=\"inputErrorDiv\">\n                                    {\n                                            this.props.courses.map(course =>{\n                                                const { name, department, semester } = course\n                                                return <div key={ name+department+semester } className=\"courseCheckboxDiv\">\n                                                            <div>\n                                                            <input\n                                                                type=\"checkbox\"\n                                                                id={name}\n                                                                placeholder=\"\"\n                                                                value={this.state.data[name]}\n                                                                onChange={this.onInputChange}\n                                                            />\n                                                            </div>\n                                                            <div>\n                                                            <label \n                                                                className=\"Label\"\n                                                                htmlFor={name}\n                                                            >\n                                                                {name} {this.state.messages[name] && <span className=\"confirmationMessage\" >{this.state.messages[name]}</span>}\n                                                            </label>\n                                                            </div>\n                                                        </div>\n                                            })\n                                    }\n                                    {this.state.errors.courseError && <span className=\"errorMessage\">{this.state.errors.courseError}</span>}\n                                    </div>\n                                </div>\n\n                                <div>\n                                    <label \n                                        className=\"Label\"\n                                        htmlFor=\"name\"\n                                    >\n                                        Upload Image\n                                    </label>\n                                    <div className=\"inputErrorDiv\">\n                                        <div className=\"inputDiv\">\n                                            <input\n                                                type=\"file\"\n                                                id=\"studentImage\"\n                                                placeholder=\"\"\n                                                onChange={this.onFileInputChange}\n                                            />\n                                        </div>\n                                        {this.state.errors.fileError && <span className=\"errorMessage\">{this.state.errors.fileError}</span>}\n                                    </div>\n                                </div>\n                                <button className=\"Button\">\n                                    Enroll\n                                </button>\n                            </form>\n                        </div>\n                    </div>\n                </div>\n            )\n        }\n    }\n}\n\nconst mapStateToProps = (state)=>{\n    return {\n        students: state.students,\n        courses: state.courses\n    }\n}\n\nconst mapDispatchToProps = (dispatch)=>{\n    return{\n        setStudents : (filters,projection) => dispatch(getAndSetStudents(filters,projection)),\n        setCourses : (filters,projection) => dispatch(getAndSetCourses(filters,projection))\n    }\n}\n\nexport default connect(mapStateToProps,mapDispatchToProps)(EnrollToCoursePage);"]},"metadata":{},"sourceType":"module"}